#!/usr/bin/env bash

# Shortcut for `nix shell nixpkgs#$1`, plus some niceties.

if [ -z "$1" ]; then echo "You must specify a package"; exit 1; fi

if [ -z "$GOTTEN_NIX_PKGS" ]; then
    export GOTTEN_NIX_PKGS="$1"
else
    export GOTTEN_NIX_PKGS="$GOTTEN_NIX_PKGS, $1"
fi

args=()
args+=("--impure") # https://discourse.nixos.org/t/nix-run-does-not-install-unfree-packages-nixpkgs-allow-unfree-doesnt-seem-to-help/12039
if [ "$#" -gt 1 ]; then
    shift
    args+=("--command" "$0" "$@")
fi

exec nix shell "nixpkgs#$1" "${args[@]}"
